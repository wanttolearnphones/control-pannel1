<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Ritters - Auth</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --bg:#0f0f13; --panel:#16161a; --accent:#6c63ff; --text:#fff;
    }
    body{margin:0;font-family:Segoe UI,Roboto,Arial;background:linear-gradient(135deg,#0b0b0d,#121216);color:var(--text);display:flex;align-items:center;justify-content:center;height:100vh}
    .card{width:360px;padding:20px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));box-shadow:0 6px 20px rgba(0,0,0,0.6)}
    h2{margin:0 0 12px;font-weight:600;text-shadow:0 1px 3px rgba(0,0,0,0.6)}
    input{width:100%;padding:10px;margin:8px 0;border-radius:8px;border:none;background:#1b1b1f;color:var(--text)}
    button{width:100%;padding:10px;margin-top:8px;border-radius:8px;border:none;background:var(--accent);color:#fff;font-weight:600;cursor:pointer}
    .row{display:flex;gap:8px}
    .row button{flex:1}
    .small{font-size:0.9rem;color:#cfcfe0;margin-top:8px}
    .link{color:var(--accent);cursor:pointer}
    .preview{width:76px;height:76px;border-radius:50%;object-fit:cover;border:2px solid rgba(255,255,255,0.06)}
    .top{display:flex;align-items:center;gap:12px}
  </style>
</head>
<body>
  <div class="card">
    <div class="top">
      <img id="authPreview" class="preview" src="" alt="profile" />
      <div style="flex:1">
        <h2 id="authTitle">Welcome — Sign Up / Login</h2>
        <div class="small">Create a profile or sign in to open Ritters Control Panel.</div>
      </div>
    </div>

    <div style="margin-top:12px">
      <input id="username" placeholder="Username" />
      <input id="password" placeholder="Password" type="password" />
      <input id="bio" placeholder="Short bio (optional)" />
      <label class="small" style="display:block;margin-top:8px">Profile picture (optional)</label>
      <input id="pic" type="file" accept="image/*" />
      <div class="row" style="margin-top:10px">
        <button id="signupBtn">Sign Up</button>
        <button id="loginBtn" style="background:#3b3b3b">Login</button>
      </div>
      <div id="authMessage" class="small" style="margin-top:8px"></div>
      <div style="margin-top:8px" class="small">Need a quick test account? use: <span class="link" id="demoFill">demo/demo</span></div>
    </div>
  </div>

<script>
(function(){
  // Simple localStorage-based auth (no backend). Passwords are stored as plain text here for simplicity.
  // For any real app, never store plain passwords client-side.
  const usersKey = 'ritters_users'; // stores object { username: {password, bio, picDataUrl, joined} }
  const currentUserKey = 'ritters_currentUser';

  const usernameEl = document.getElementById('username');
  const passwordEl = document.getElementById('password');
  const bioEl = document.getElementById('bio');
  const picEl = document.getElementById('pic');
  const preview = document.getElementById('authPreview');
  const authMessage = document.getElementById('authMessage');

  // helper: get users map
  function getUsers(){ return JSON.parse(localStorage.getItem(usersKey) || '{}'); }
  function saveUsers(u){ localStorage.setItem(usersKey, JSON.stringify(u)); }

  // preview image to dataURL
  picEl.addEventListener('change', ()=> {
    const f = picEl.files[0];
    if(!f) { preview.src = ''; return; }
    const r = new FileReader();
    r.onload = () => preview.src = r.result;
    r.readAsDataURL(f);
  });

  // Signup
  document.getElementById('signupBtn').addEventListener('click', async ()=>{
    const name = usernameEl.value.trim();
    const pass = passwordEl.value;
    if(!name || !pass) { authMessage.textContent = 'Username & password required.'; return; }
    const users = getUsers();
    if(users[name]) { authMessage.textContent = 'Username already taken.'; return; }

    let picData = preview.src || '';
    const joined = (new Date()).toISOString();
    users[name] = { password: pass, bio: bioEl.value||'', pic: picData, joined };
    saveUsers(users);
    localStorage.setItem(currentUserKey, name);
    authMessage.textContent = 'Account created — redirecting...';
    setTimeout(()=> location.href = 'index.html', 700);
  });

  // Login
  document.getElementById('loginBtn').addEventListener('click', ()=>{
    const name = usernameEl.value.trim();
    const pass = passwordEl.value;
    if(!name || !pass) { authMessage.textContent = 'Username & password required.'; return; }
    const users = getUsers();
    if(!users[name] || users[name].password !== pass) { authMessage.textContent = 'Invalid credentials.'; return; }
    localStorage.setItem(currentUserKey, name);
    authMessage.textContent = 'Login success — redirecting...';
    setTimeout(()=> location.href = 'index.html', 400);
  });

  // demo filler
  document.getElementById('demoFill').addEventListener('click', ()=>{
    usernameEl.value = 'demo';
    passwordEl.value = 'demo';
    // ensure demo user exists
    const users = getUsers();
    if(!users.demo){
      users.demo = { password:'demo', bio:'Demo user', pic:'', joined:(new Date()).toISOString() };
      saveUsers(users);
    }
  });

  // If already logged in, go straight to index
  const current = localStorage.getItem(currentUserKey);
  if(current) location.href = 'index.html';

})();
</script>
</body>
</html>